<div class="background-container bg-white flex items-center justify-center min-h-screen">
  <div class="container flex flex-col justify-center items-center p-8 w-full">
    @if (errorMessage()) {
      <div class="error-message">
        {{ errorMessage() }}
      </div>
    }

    @switch (viewState()) {
      @case ('upload') {
        <app-file-upload (fileSelected)="onFileSelected($event)" />
      }
      @case ('loading') {
        <div class="loading-container">
          <mat-spinner></mat-spinner>
          <p class="loading-text">Processing your anime list...</p>
        </div>
      }
      @case ('comparing') {
        <div class="comparison-with-results">
          @if (leftAnime() && rightAnime()) {
            <app-anime-comparison
              [leftAnime]="leftAnime()!"
              [rightAnime]="rightAnime()!"
              [progress]="progress()"
              [comparisonsDone]="comparisonState().comparisonsDone"
              [totalComparisons]="comparisonState().totalComparisons"
              [canUndo]="canUndo()"
              [canRedo]="canRedo()"
              (animeSelected)="onAnimeSelected($event)"
              (comparisonSkipped)="onComparisonSkipped()"
              (rankingDiscarded)="onRankingDiscarded()"
              (undoRequested)="onUndo()"
              (redoRequested)="onRedo()"
              (exportRequested)="onExport()"
            />
          }
          <app-ranking-results
            [rankedAnime]="liveRatingsWithImages()"
            [isLiveMode]="true"
            [accuracy]="accuracy()"
          />
        </div>
      }
      @case ('results') {
        <app-ranking-results
          [rankedAnime]="rankedAnime()"
          (exportRequested)="onExport()"
          (resetRequested)="onReset()"
        />
      }
    }
  </div>
</div>
